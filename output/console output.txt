Using TensorFlow backend.
Train MLP I: SGD without nesterov...
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 182s - loss: 0.5060 - acc: 0.8450 - val_loss: 0.2462 - val_acc: 0.9278
Epoch 2/20
 - 176s - loss: 0.3293 - acc: 0.9019 - val_loss: 0.2157 - val_acc: 0.9367
Epoch 3/20
 - 174s - loss: 0.2991 - acc: 0.9117 - val_loss: 0.2014 - val_acc: 0.9382
Epoch 4/20
 - 173s - loss: 0.2824 - acc: 0.9155 - val_loss: 0.1918 - val_acc: 0.9422
Epoch 5/20
 - 173s - loss: 0.2706 - acc: 0.9203 - val_loss: 0.1857 - val_acc: 0.9437
Epoch 6/20
 - 174s - loss: 0.2618 - acc: 0.9219 - val_loss: 0.1808 - val_acc: 0.9449
Epoch 7/20
 - 177s - loss: 0.2564 - acc: 0.9242 - val_loss: 0.1769 - val_acc: 0.9464
Epoch 8/20
 - 177s - loss: 0.2509 - acc: 0.9247 - val_loss: 0.1741 - val_acc: 0.9474
Epoch 9/20
 - 173s - loss: 0.2471 - acc: 0.9264 - val_loss: 0.1709 - val_acc: 0.9486
Epoch 10/20
 - 173s - loss: 0.2420 - acc: 0.9272 - val_loss: 0.1692 - val_acc: 0.9490
Epoch 11/20
 - 174s - loss: 0.2411 - acc: 0.9282 - val_loss: 0.1672 - val_acc: 0.9492
Epoch 12/20
 - 174s - loss: 0.2378 - acc: 0.9303 - val_loss: 0.1650 - val_acc: 0.9498
Epoch 13/20
 - 171s - loss: 0.2350 - acc: 0.9302 - val_loss: 0.1631 - val_acc: 0.9506
Epoch 14/20
 - 173s - loss: 0.2317 - acc: 0.9312 - val_loss: 0.1618 - val_acc: 0.9512
Epoch 15/20
 - 174s - loss: 0.2333 - acc: 0.9323 - val_loss: 0.1601 - val_acc: 0.9514
Epoch 16/20
 - 173s - loss: 0.2301 - acc: 0.9316 - val_loss: 0.1590 - val_acc: 0.9523
Epoch 17/20
 - 174s - loss: 0.2289 - acc: 0.9331 - val_loss: 0.1580 - val_acc: 0.9526
Epoch 18/20
 - 184s - loss: 0.2265 - acc: 0.9332 - val_loss: 0.1567 - val_acc: 0.9526
Epoch 19/20
 - 173s - loss: 0.2228 - acc: 0.9340 - val_loss: 0.1557 - val_acc: 0.9529
Epoch 20/20
 - 182s - loss: 0.2219 - acc: 0.9337 - val_loss: 0.1548 - val_acc: 0.9540
Train MLP II: SGD with nesterov...
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 195s - loss: 0.3285 - acc: 0.8988 - val_loss: 0.1303 - val_acc: 0.9597
Epoch 2/20
 - 196s - loss: 0.1793 - acc: 0.9460 - val_loss: 0.1106 - val_acc: 0.9642
Epoch 3/20
 - 195s - loss: 0.1534 - acc: 0.9549 - val_loss: 0.1002 - val_acc: 0.9680
Epoch 4/20
 - 196s - loss: 0.1419 - acc: 0.9571 - val_loss: 0.0949 - val_acc: 0.9692
Epoch 5/20
 - 195s - loss: 0.1330 - acc: 0.9603 - val_loss: 0.0913 - val_acc: 0.9704
Epoch 6/20
 - 195s - loss: 0.1260 - acc: 0.9616 - val_loss: 0.0885 - val_acc: 0.9722
Epoch 7/20
 - 197s - loss: 0.1223 - acc: 0.9634 - val_loss: 0.0866 - val_acc: 0.9727
Epoch 8/20
 - 197s - loss: 0.1187 - acc: 0.9644 - val_loss: 0.0850 - val_acc: 0.9724
Epoch 9/20
 - 190s - loss: 0.1142 - acc: 0.9664 - val_loss: 0.0834 - val_acc: 0.9728
Epoch 10/20
 - 190s - loss: 0.1128 - acc: 0.9664 - val_loss: 0.0818 - val_acc: 0.9737
Epoch 11/20
 - 190s - loss: 0.1117 - acc: 0.9664 - val_loss: 0.0816 - val_acc: 0.9734
Epoch 12/20
 - 194s - loss: 0.1071 - acc: 0.9673 - val_loss: 0.0807 - val_acc: 0.9739
Epoch 13/20
 - 195s - loss: 0.1069 - acc: 0.9680 - val_loss: 0.0799 - val_acc: 0.9738
Epoch 14/20
 - 197s - loss: 0.1072 - acc: 0.9678 - val_loss: 0.0790 - val_acc: 0.9744
Epoch 15/20
 - 196s - loss: 0.1025 - acc: 0.9690 - val_loss: 0.0783 - val_acc: 0.9748
Epoch 16/20
 - 199s - loss: 0.1016 - acc: 0.9698 - val_loss: 0.0775 - val_acc: 0.9746
Epoch 17/20
 - 194s - loss: 0.0993 - acc: 0.9698 - val_loss: 0.0769 - val_acc: 0.9747
Epoch 18/20
 - 190s - loss: 0.1013 - acc: 0.9696 - val_loss: 0.0764 - val_acc: 0.9748
Epoch 19/20
 - 191s - loss: 0.0990 - acc: 0.9702 - val_loss: 0.0762 - val_acc: 0.9752
Epoch 20/20
 - 193s - loss: 0.0968 - acc: 0.9711 - val_loss: 0.0758 - val_acc: 0.9759
Train MLP III: SGD with nesterov and l1 regularization...
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 332s - loss: 3.3323 - acc: 0.4965 - val_loss: 1.6505 - val_acc: 0.7759
Epoch 2/20
 - 328s - loss: 1.9042 - acc: 0.5955 - val_loss: 1.3232 - val_acc: 0.8158
Epoch 3/20
 - 330s - loss: 1.7331 - acc: 0.6242 - val_loss: 1.2344 - val_acc: 0.8431
Epoch 4/20
 - 333s - loss: 1.6323 - acc: 0.6405 - val_loss: 1.1772 - val_acc: 0.8328
Epoch 5/20
 - 325s - loss: 1.5504 - acc: 0.6578 - val_loss: 1.0949 - val_acc: 0.8482
Epoch 6/20
 - 327s - loss: 1.4976 - acc: 0.6658 - val_loss: 1.0636 - val_acc: 0.8492
Epoch 7/20
 - 324s - loss: 1.4601 - acc: 0.6729 - val_loss: 1.0450 - val_acc: 0.8599
Epoch 8/20
 - 324s - loss: 1.4251 - acc: 0.6790 - val_loss: 1.0077 - val_acc: 0.8608
Epoch 9/20
 - 323s - loss: 1.3931 - acc: 0.6841 - val_loss: 1.0179 - val_acc: 0.8504
Epoch 10/20
 - 331s - loss: 1.3703 - acc: 0.6881 - val_loss: 0.9260 - val_acc: 0.8659
Epoch 11/20
 - 325s - loss: 1.3419 - acc: 0.6925 - val_loss: 0.9131 - val_acc: 0.8656
Epoch 12/20
 - 324s - loss: 1.3270 - acc: 0.6956 - val_loss: 0.8976 - val_acc: 0.8746
Epoch 13/20
 - 325s - loss: 1.3117 - acc: 0.6961 - val_loss: 0.9366 - val_acc: 0.8497
Epoch 14/20
 - 324s - loss: 1.2950 - acc: 0.7003 - val_loss: 0.8961 - val_acc: 0.8643
Epoch 15/20
 - 325s - loss: 1.2866 - acc: 0.7022 - val_loss: 0.8689 - val_acc: 0.8798
Epoch 16/20
 - 324s - loss: 1.2684 - acc: 0.7055 - val_loss: 0.8453 - val_acc: 0.8776
Epoch 17/20
 - 324s - loss: 1.2593 - acc: 0.7062 - val_loss: 0.8694 - val_acc: 0.8733
Epoch 18/20
 - 324s - loss: 1.2478 - acc: 0.7085 - val_loss: 0.8329 - val_acc: 0.8791
Epoch 19/20
 - 323s - loss: 1.2350 - acc: 0.7104 - val_loss: 0.8195 - val_acc: 0.8807
Epoch 20/20
 - 337s - loss: 1.2273 - acc: 0.7111 - val_loss: 0.8415 - val_acc: 0.8774
Train MLP IV: SGD with nesterov and l2 regularization...
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 235s - loss: 1.1524 - acc: 0.8754 - val_loss: 0.3696 - val_acc: 0.9404
Epoch 2/20
 - 227s - loss: 0.4024 - acc: 0.9254 - val_loss: 0.2857 - val_acc: 0.9555
Epoch 3/20
 - 224s - loss: 0.3340 - acc: 0.9377 - val_loss: 0.2421 - val_acc: 0.9611
Epoch 4/20
 - 224s - loss: 0.2959 - acc: 0.9446 - val_loss: 0.2187 - val_acc: 0.9645
Epoch 5/20
 - 225s - loss: 0.2756 - acc: 0.9477 - val_loss: 0.2100 - val_acc: 0.9647
Epoch 6/20
 - 225s - loss: 0.2577 - acc: 0.9508 - val_loss: 0.2013 - val_acc: 0.9660
Epoch 7/20
 - 226s - loss: 0.2443 - acc: 0.9534 - val_loss: 0.1924 - val_acc: 0.9674
Epoch 8/20
 - 231s - loss: 0.2370 - acc: 0.9553 - val_loss: 0.1837 - val_acc: 0.9683
Epoch 9/20
 - 225s - loss: 0.2291 - acc: 0.9573 - val_loss: 0.1794 - val_acc: 0.9678
Epoch 10/20
 - 224s - loss: 0.2217 - acc: 0.9579 - val_loss: 0.1756 - val_acc: 0.9702
Epoch 11/20
 - 224s - loss: 0.2168 - acc: 0.9580 - val_loss: 0.1711 - val_acc: 0.9711
Epoch 12/20
 - 224s - loss: 0.2125 - acc: 0.9598 - val_loss: 0.1686 - val_acc: 0.9714
Epoch 13/20
 - 224s - loss: 0.2081 - acc: 0.9608 - val_loss: 0.1667 - val_acc: 0.9708
Epoch 14/20
 - 233s - loss: 0.2055 - acc: 0.9613 - val_loss: 0.1621 - val_acc: 0.9720
Epoch 15/20
 - 224s - loss: 0.2013 - acc: 0.9611 - val_loss: 0.1661 - val_acc: 0.9708
Epoch 16/20
 - 235s - loss: 0.1974 - acc: 0.9614 - val_loss: 0.1604 - val_acc: 0.9726
Epoch 17/20
 - 224s - loss: 0.1958 - acc: 0.9624 - val_loss: 0.1565 - val_acc: 0.9727
Epoch 18/20
 - 225s - loss: 0.1919 - acc: 0.9639 - val_loss: 0.1540 - val_acc: 0.9734
Epoch 19/20
 - 223s - loss: 0.1906 - acc: 0.9638 - val_loss: 0.1532 - val_acc: 0.9726
Epoch 20/20
 - 224s - loss: 0.1880 - acc: 0.9642 - val_loss: 0.1547 - val_acc: 0.9725
Classification accuracy for MLP-I:
95.39999999999999
Classification accuracy for MLP-II:
97.59
Classification accuracy for MLP-III:
87.74
Classification accuracy for MLP-IV:
97.25
Saved model to disk
Saved model to disk
Saved model to disk
Saved model to disk